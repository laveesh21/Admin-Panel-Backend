CREATE TABLE User (
  id CHAR(36) NOT NULL PRIMARY KEY, -- UUID
  username VARCHAR(255) NOT NULL UNIQUE,
  email VARCHAR(255) NOT NULL UNIQUE,
  password VARCHAR(255) NOT NULL,
  roleId CHAR(36),
  createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,
  updatedAt DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (roleId) REFERENCES Role(id)
);



CREATE TABLE Role (
  id CHAR(36) NOT NULL PRIMARY KEY, -- UUID
  name ENUM('Admin', 'Manager', 'Employee') NOT NULL UNIQUE,
  permissions JSON DEFAULT '[]', -- JSON array for permissions
  createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,
  updatedAt DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);




CREATE TABLE Project (
  id CHAR(36) NOT NULL PRIMARY KEY, -- UUID
  name VARCHAR(255) NOT NULL,
  description TEXT,
  createdBy CHAR(36),
  assignedTo JSON DEFAULT '[]', -- JSON array for user IDs assigned to the project
  deletedAt DATETIME DEFAULT NULL, -- For soft delete
  createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,
  updatedAt DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (createdBy) REFERENCES User(id)
);



CREATE TABLE AuditLog (
  id CHAR(36) NOT NULL PRIMARY KEY, -- UUID
  action VARCHAR(255) NOT NULL,
  performedBy CHAR(36),
  performedAt DATETIME DEFAULT CURRENT_TIMESTAMP,
  targetResource VARCHAR(255),
  FOREIGN KEY (performedBy) REFERENCES User(id)
);
